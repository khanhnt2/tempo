name: Test Suite

on:
    pull_request:
    push:
        branches:
            - main

jobs:
    test:
        name: Run tests
        runs-on: ubuntu-latest
        container:
            image: rust:1.78.0
        steps:
            - uses: actions/checkout@v4
            - name: Cache dependencies
              uses: Swatinem/rust-cache@v2.7.3
            - name: Build
              run : |
                cargo build
            - name: Install clippy
              run: |
                rustup component add clippy
            - name: Run cargo clippy
              env:
                RUSTFLAGS: "-Dwarnings"
              run: |
                cargo clippy --all-targets
            - name: Install rustfmt
              run: |
                rustup component add rustfmt
            - name: Run cargo fmt
              run: |
                cargo fmt --all -- --check
